  0%|                                                                                                                                                                                                      | 0/2 [00:00<?, ?it/s]c:\Users\diogo\Desktop\VS\ML\NNZeroToHero\GPT\GPT3\gpt.py:262: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at ..\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:455.)
  y = F.scaled_dot_product_attention(q, k, v, is_causal=True)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.05s/it]
Step 0/50, Loss: 10.976715087890625 - LR: 0.000014900 - Time taken: 4074.3472576141357 - Tokens/second: 502.6572038435604 - Time Remaining: 0h:3m:23s
Evaluating
Validation Loss: 10.90420
  0%|                                                                                                                                                                                                      | 0/2 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.10s/it]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.24it/s]
Step 2/50, Loss: 10.64508056640625 - LR: 0.000034700 - Time taken: 3505.387306213379 - Tokens/second: 584.2435717074326 - Time Remaining: 0h:2m:48s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.24it/s]
Step 3/50, Loss: 10.420684814453125 - LR: 0.000044600 - Time taken: 3520.224094390869 - Tokens/second: 581.7811437809561 - Time Remaining: 0h:2m:45s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.24it/s]
Step 4/50, Loss: 10.18377685546875 - LR: 0.000054500 - Time taken: 3514.0163898468018 - Tokens/second: 582.8088923880305 - Time Remaining: 0h:2m:41s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.24it/s]
Step 5/50, Loss: 10.127304077148438 - LR: 0.000064400 - Time taken: 3526.895761489868 - Tokens/second: 580.680615050234 - Time Remaining: 0h:2m:38s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.24it/s]
Step 6/50, Loss: 9.942245483398438 - LR: 0.000074300 - Time taken: 3516.5674686431885 - Tokens/second: 582.3860961752536 - Time Remaining: 0h:2m:34s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.08it/s]
Step 7/50, Loss: 9.734573364257812 - LR: 0.000084200 - Time taken: 3530.1294326782227 - Tokens/second: 580.1486996600668 - Time Remaining: 0h:2m:31s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.23it/s]
Step 8/50, Loss: 9.829833984375 - LR: 0.000094100 - Time taken: 3541.9113636016846 - Tokens/second: 578.2188738674245 - Time Remaining: 0h:2m:28s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
C:\Users\diogo\Desktop\VS\ML\NNZeroToHero\GPT\.venv\Lib\site-packages\torch\optim\lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
  0%|                                                                                                                                                                                                      | 0/2 [00:00<?, ?it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.22it/s]
Step 10/50, Loss: 9.739273071289062 - LR: 0.000499322 - Time taken: 3549.7941970825195 - Tokens/second: 576.9348548947419 - Time Remaining: 0h:2m:21s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 11/50, Loss: 9.419418334960938 - LR: 0.000497291 - Time taken: 3579.5845985412598 - Tokens/second: 572.1334259943442 - Time Remaining: 0h:2m:19s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 12/50, Loss: 9.257766723632812 - LR: 0.000493921 - Time taken: 3576.1725902557373 - Tokens/second: 572.6792956191034 - Time Remaining: 0h:2m:15s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 13/50, Loss: 8.932846069335938 - LR: 0.000489232 - Time taken: 3586.7602825164795 - Tokens/second: 570.9888140511912 - Time Remaining: 0h:2m:12s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 14/50, Loss: 8.63031005859375 - LR: 0.000483253 - Time taken: 3580.2383422851562 - Tokens/second: 572.0289556736116 - Time Remaining: 0h:2m:8s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 15/50, Loss: 8.600303649902344 - LR: 0.000476021 - Time taken: 3585.796594619751 - Tokens/second: 571.1422681010093 - Time Remaining: 0h:2m:5s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 16/50, Loss: 8.989280700683594 - LR: 0.000467581 - Time taken: 3564.241647720337 - Tokens/second: 574.5962823002997 - Time Remaining: 0h:2m:1s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
Step 17/50, Loss: 8.733383178710938 - LR: 0.000457984 - Time taken: 3596.5306758880615 - Tokens/second: 569.4376566089776 - Time Remaining: 0h:1m:58s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
  0%|                                                                                                                                                                                                      | 0/2 [00:00<?, ?it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
Step 19/50, Loss: 8.5655517578125 - LR: 0.000435563 - Time taken: 3577.150821685791 - Tokens/second: 572.5226869340797 - Time Remaining: 0h:1m:50s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 20/50, Loss: 8.4556884765625 - LR: 0.000422879 - Time taken: 3580.0814628601074 - Tokens/second: 572.0540220232486 - Time Remaining: 0h:1m:47s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
Step 21/50, Loss: 8.244392395019531 - LR: 0.000409313 - Time taken: 3586.6212844848633 - Tokens/second: 571.010942487659 - Time Remaining: 0h:1m:44s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.18it/s]
Step 22/50, Loss: 8.29339599609375 - LR: 0.000394950 - Time taken: 3599.4272232055664 - Tokens/second: 568.9794161683587 - Time Remaining: 0h:1m:40s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
  0%|                                                                                                                                                                                                      | 0/2 [00:00<?, ?it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 24/50, Loss: 8.378898620605469 - LR: 0.000364190 - Time taken: 3563.8296604156494 - Tokens/second: 574.6627070164576 - Time Remaining: 0h:1m:32s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 25/50, Loss: 8.004043579101562 - LR: 0.000347984 - Time taken: 3550.198554992676 - Tokens/second: 576.8691435919491 - Time Remaining: 0h:1m:28s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 26/50, Loss: 8.13128662109375 - LR: 0.000331358 - Time taken: 3564.7013187408447 - Tokens/second: 574.5221876607078 - Time Remaining: 0h:1m:25s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 27/50, Loss: 8.283454895019531 - LR: 0.000314416 - Time taken: 3561.746597290039 - Tokens/second: 574.9987945684356 - Time Remaining: 0h:1m:21s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 28/50, Loss: 8.133895874023438 - LR: 0.000297261 - Time taken: 3540.5876636505127 - Tokens/second: 578.4350493636459 - Time Remaining: 0h:1m:17s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 29/50, Loss: 7.833091735839844 - LR: 0.000280000 - Time taken: 3562.9117488861084 - Tokens/second: 574.8107571399368 - Time Remaining: 0h:1m:14s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 30/50, Loss: 7.63372802734375 - LR: 0.000262739 - Time taken: 3543.7562465667725 - Tokens/second: 577.9178525566265 - Time Remaining: 0h:1m:10s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
Step 31/50, Loss: 7.6573333740234375 - LR: 0.000245584 - Time taken: 3563.0478858947754 - Tokens/second: 574.7887947584215 - Time Remaining: 0h:1m:7s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
  0%|                                                                                                                                                                                                      | 0/2 [00:00<?, ?it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.22it/s]
Step 33/50, Loss: 7.802482604980469 - LR: 0.000212016 - Time taken: 3549.4728088378906 - Tokens/second: 576.987093660966 - Time Remaining: 0h:1m:0s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 34/50, Loss: 7.9950714111328125 - LR: 0.000195810 - Time taken: 3555.844783782959 - Tokens/second: 575.9531488382889 - Time Remaining: 0h:0m:56s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.22it/s]
Step 35/50, Loss: 8.517532348632812 - LR: 0.000180122 - Time taken: 3549.1535663604736 - Tokens/second: 577.0389930183125 - Time Remaining: 0h:0m:53s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
Step 36/50, Loss: 7.9079132080078125 - LR: 0.000165050 - Time taken: 3566.1988258361816 - Tokens/second: 574.2809360944133 - Time Remaining: 0h:0m:49s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 37/50, Loss: 7.875640869140625 - LR: 0.000150687 - Time taken: 3554.3131828308105 - Tokens/second: 576.2013347312527 - Time Remaining: 0h:0m:46s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 38/50, Loss: 7.8363800048828125 - LR: 0.000137121 - Time taken: 3553.91526222229 - Tokens/second: 576.2658501653104 - Time Remaining: 0h:0m:42s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 39/50, Loss: 8.105796813964844 - LR: 0.000124437 - Time taken: 3572.784423828125 - Tokens/second: 573.2223826159747 - Time Remaining: 0h:0m:39s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 40/50, Loss: 7.9504547119140625 - LR: 0.000112711 - Time taken: 3563.4419918060303 - Tokens/second: 574.7252248554294 - Time Remaining: 0h:0m:35s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
  0%|                                                                                                                                                                                                      | 0/2 [00:00<?, ?it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.17it/s]
Step 42/50, Loss: 7.893806457519531 - LR: 0.000092419 - Time taken: 3575.3109455108643 - Tokens/second: 572.817310497554 - Time Remaining: 0h:0m:28s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 43/50, Loss: 7.798835754394531 - LR: 0.000083979 - Time taken: 3557.5625896453857 - Tokens/second: 575.6750439081221 - Time Remaining: 0h:0m:24s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]
Step 44/50, Loss: 8.079490661621094 - LR: 0.000076747 - Time taken: 3568.4170722961426 - Tokens/second: 573.9239440086494 - Time Remaining: 0h:0m:21s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
Step 45/50, Loss: 8.017807006835938 - LR: 0.000070768 - Time taken: 3584.6564769744873 - Tokens/second: 571.3239227119882 - Time Remaining: 0h:0m:17s
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.20it/s]
Step 46/50, Loss: 7.6084442138671875 - LR: 0.000066079 - Time taken: 3572.3557472229004 - Tokens/second: 573.2911683255753 - Time Remaining: 0h:0m:14s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
Step 47/50, Loss: 7.948577880859375 - LR: 0.000062709 - Time taken: 3581.7880630493164 - Tokens/second: 571.7814577383056 - Time Remaining: 0h:0m:10s

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.19it/s]
Step 48/50, Loss: 8.1162109375 - LR: 0.000060678 - Time taken: 3567.803382873535 - Tokens/second: 574.0226633090206 - Time Remaining: 0h:0m:7s


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.22s/it]
Step 49/50, Loss: 7.7145233154296875 - LR: 0.000060000 - Time taken: 6335.074901580811 - Tokens/second: 323.279524207197 - Time Remaining: 0h:0m:6s